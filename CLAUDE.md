# CLAUDE.md

!!!!!DO NOT EDIT THIS FILE WITHOUT EXPLICIT USER CONSENT!!!!!

## Project: BURNWISE
Multi-farm agricultural burn coordination system (TiDB AgentX Hackathon 2025). 5-agent workflow with TiDB vector search to prevent smoke conflicts.

## Commands
```bash
npm run dev              # Start backend (5001) + frontend (3000)
npm run install:all      # Install all dependencies  
npm run setup:check      # Verify configs & API keys
npm run seed            # Populate demo data
npm test                # Run all tests
cd e2e-tests && npx playwright test [--headed]
```

## Navigation Guides
**IMPORTANT**: Check `.claude/` directory for comprehensive navigation files:
- `.claude/NAVIGATION.md` - Quick jump to any file/function
- `.claude/CODEBASE_MAP.md` - Visual file tree with descriptions
- `.claude/TECH_STACK.md` - All libraries & versions
- `.claude/DATABASE_SCHEMA.md` - TiDB tables & vector operations
- `.claude/PATTERNS.md` - Code conventions used throughout
- `.claude/WORKFLOWS/` - Detailed workflow documentation
- `.claude/QUICK_TASKS/` - Step-by-step common operations

Start with `.claude/NAVIGATION.md` for efficient codebase traversal.

## Architecture
**Agents** (`backend/agents/`): coordinator (validate/score), weather (OpenWeather/128-dim vectors), predictor (Gaussian plume), optimizer (simulated annealing), alerts (Twilio SMS)
**Stack**: TiDB + circuit breaker (`backend/db/connection.js`), React Router + Mapbox (`Map.js`), Socket.io
**API**: `/api/{burn-requests,weather,schedule,alerts,farms,analytics}`

## Required Setup
- TiDB credentials in `backend/.env`
- OpenWeatherMap API key (`OPENWEATHERMAP_API_KEY`)  
- Mapbox token in `frontend/.env` (`REACT_APP_MAPBOX_TOKEN`)

## Technical Specs
**Algorithms**: Gaussian plume (`weather.js:predictSmokeDispersion()`), simulated annealing (`optimizer.js:simulatedAnnealing()`)
**Vectors**: Weather 128-dim, smoke 64-dim, burns 32-dim | **Reliability**: Circuit breaker (5 fail), rate limit (100/15min), pool (max 10)
**Testing**: Unit (`backend/tests/agents/`), Integration (`five-agent-workflow.test.js`), E2E (Playwright)
**UI**: Fire theme, glass morphism (`theme.css`), `FullScreenStartup.js`

## Development Standards

### Code Quality
- **NEVER** use profanity/offensive language in code, comments, variables, functions, or documentation
- **ALWAYS** scan codebase for CLAUDE.md violations before changes
- **NEVER** create redundant files - update/rename existing files instead
- Use descriptive naming reflecting business domain
- **ALWAYS** update `.claude/` context files when codebase structure changes significantly
- **PROACTIVELY** maintain navigation guides when adding/removing major features

### Git Standards
- Commit early/often, one logical change per commit
- Message: `<type>(<scope>): <subject>\n\n<body â€“ what & why>`
- Never commit generated files, secrets, .env*, CLAUDE.md, agent configs
- PRs need description, screenshots/gifs for UI, test evidence

### Debugging Checklist
- Bug reproducible? Offending line identified? Regression tests included?
- Existing tests pass? Performance unchanged/improved? Docs updated?
- Manual QA by mimicking real user behavior?
If any box unchecked, do NOT declare issue fixed.

### Prohibited Behaviors
- Claiming code works without running it
- Large refactors without prior tests
- Mock data unless explicitly required
- Deleting code without user approval
- Experimental language features without toolchain verification

### Response Format
**Summary**: <plain-English explanation>
**Changes Made**: <bulleted list of files & functions>
**How to Test**: <commands & expected output>
**Next Steps/Questions**: <clarifications needed>

### Claude Code Notes
- Use Run Panel and sandbox, attach transcript snippets
- Run `claude test` before/after changes, paste results
- Include fully-qualified identifiers for copy-paste
- Provide ordered patch sequence for multi-file fixes

## When Unsure

STOP, ASK, AND WAIT. List concrete questions, propose assumptions, and pause until the user confirms.